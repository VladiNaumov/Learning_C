/* 14 File Systems */

/*
Устройства в Linux представлены в каталоге `/dev`, каждое имеет драйвер, который поддерживает операции, связанные с системными вызовами `open()`, `read()`, `write()`, и `close()`. 
Устройства могут быть реальными (аппаратными) или виртуальными, но все они используют единый API.

Жесткий диск может иметь разделы с файловыми системами, такими как ext2, которая включает загрузочный блок, суперблок, таблицу индексных дескрипторов и блоки данных. 
Эти таблицы хранят информацию о файле: его тип, размер, права доступа и т.д.

Linux поддерживает и журналируемые файловые системы (ReiserFS, ext3, ext4, XFS, JFS, Btrfs), которые записывают изменения метаданных в журнал. 
Это позволяет быстро восстановить систему после сбоя, избегая длительной проверки целостности.

Все файловые системы монтируются в едином дереве каталогов с корнем в `/`, где каждая точка монтирования определяет местоположение файловой системы. 
Для монтирования и размонтирования используются вызовы `mount()` и `umount()`. Информацию о файловой системе можно получить через `statvfs()`.

*/


/*
Функция mount():
Используется для монтирования файловой системы. Принимает параметры:
- source: исходное устройство или виртуальный источник данных,
- target: точка монтирования в дереве каталогов,
- fstype: тип файловой системы (например, "ext4", "xfs"),
- mountflags: различные флаги, такие как возможность только для чтения,
- data: дополнительные данные, зависящие от типа файловой системы.
Функция позволяет подключить новую файловую систему к дереву каталогов Linux.
*/

#include <sys/mount.h>
int mount(const char *source, const char *target, const char *fstype, unsigned long mountflags, const void *data);

/*
Функция umount():
Служит для размонтирования файловой системы, отсоединяя её от точки монтирования.
- target: точка монтирования или устройство, которое нужно размонтировать.
Используется для освобождения файловой системы, после чего доступ к ней станет невозможен.
*/

int umount(const char *target);

/*
Функция umount2():
Альтернативная версия umount(), позволяющая использовать флаги для дополнительного управления.
- target: точка монтирования или устройство,
- flags: флаги, такие как принудительное размонтирование.
Используется для более гибкого контроля размонтирования.
*/

int umount2(const char *target, int flags);

/*
Функция statvfs():
Используется для получения информации о файловой системе. Принимает:
- pathname: путь к файлу или точке монтирования,
- statvfsbuf: указатель на структуру, где будет сохранена информация о файловой системе.
Позволяет узнать параметры файловой системы, такие как размер, доступное пространство и т. д.
*/

#include <sys/statvfs.h>
int statvfs(const char *pathname, struct statvfs *statvfsbuf);

/*
Функция fstatvfs():
Похожа на statvfs(), но принимает файловый дескриптор, а не путь.
- fd: файловый дескриптор, ассоциированный с файлом или директорией,
- statvfsbuf: структура для записи информации о файловой системе.
Полезна, когда файл уже открыт, и нужен доступ к информации о файловой системе.
*/

int fstatvfs(int fd, struct statvfs *statvfsbuf);



