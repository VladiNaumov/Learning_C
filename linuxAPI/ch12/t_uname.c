/* Этот код демонстрирует использование системного вызова `uname()` для получения информации о системе, такой как:
 имя узла, операционная система, версия ядра, архитектура и, при поддержке GNU, доменное имя.*/

/* t_uname.c

   Демонстрация использования системного вызова uname(), который возвращает
   различную идентифицирующую информацию о системе.
*/



#ifdef __linux__
#define _GNU_SOURCE
#endif

#include <sys/utsname.h>
#include "tlpi_hdr.h"

int main(int argc, char *argv[]) {
    struct utsname uts;

    // Вызов uname для получения системной информации
    if (uname(&uts) == -1)
        errExit("uname");

    // Вывод информации о системе
    printf("Node name:   %s\n", uts.nodename);
    printf("System name: %s\n", uts.sysname);
    printf("Release:     %s\n", uts.release);
    printf("Version:     %s\n", uts.version);
    printf("Machine:     %s\n", uts.machine);
    
#ifdef _GNU_SOURCE
    // Вывод доменного имени, если поддерживается
    printf("Domain name: %s\n", uts.domainname);
#endif

    exit(EXIT_SUCCESS);
}

/*

### Пояснение работы кода

1. **Заголовочные файлы и макросы**:
   - Если система — Linux, макрос `_GNU_SOURCE` определяется для активации расширений GNU, чтобы `uname` возвращал дополнительное поле `domainname`.
   - Включается заголовочный файл `<sys/utsname.h>` для использования структуры `utsname` и функции `uname`.
   - `"tlpi_hdr.h"` — это заголовок, который, предположительно, определяет `errExit()` для обработки ошибок (он не является стандартным и зависит от авторской библиотеки).

2. **Основная функция**:
   - **Определение структуры `utsname`**: создается структура `uts` для хранения информации о системе.
   - **Вызов `uname`**:
     - `uname(&uts)` заполняет структуру `uts`. Если вызов возвращает `-1`, значит произошла ошибка, и `errExit("uname")` завершит программу с сообщением.
   - **Вывод информации**:
     - В структуре `utsname` хранятся различные системные параметры:
       - `uts.nodename` — имя узла (хоста) в сети.
       - `uts.sysname` — название операционной системы.
       - `uts.release` — версия ядра.
       - `uts.version` — дополнительная версия ядра.
       - `uts.machine` — архитектура системы.
     - **Расширение GNU**:
       - Если `_GNU_SOURCE` определён, дополнительно выводится `uts.domainname`, что позволяет отобразить доменное имя.

3. **Завершение программы**:
   - Программа завершается с кодом `EXIT_SUCCESS` после успешного выполнения. 

Этот код полезен для получения общей информации о системе и может быть применён, например, для создания отчётов об окружении или для диагностики.
*/