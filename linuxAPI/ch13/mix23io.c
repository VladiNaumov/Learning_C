
/* mix23io.c

   Демонстрирует влияние буферизации stdio при одновременном использовании
   функций библиотеки stdio и системных вызовов ввода-вывода для работы
   с одним и тем же файлом.

   Попробуйте запустить эту программу (с выводом в терминал) без аргумента
   командной строки и с ним (любой строкой).
*/

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
    printf("To man the world is twofold, "); // Запись в буфер stdio
    if (argc > 1)
        printf("\n"); // Если есть аргумент, добавляет символ новой строки, очищая буфер
    write(STDOUT_FILENO, "in accordance with his twofold attitude.\n", 41); // Системный вызов write() без буферизации stdio

    exit(EXIT_SUCCESS);
}

/*
### Пояснение:

- Если аргумент командной строки присутствует, `printf("\n")` добавляет новую строку, очищая буфер `stdio`. В этом случае текст `printf` выводится перед вызовом `write`.
- Если аргумента нет, строка из `printf` остаётся в буфере, и `write` может вывести свой текст до неё.
*/