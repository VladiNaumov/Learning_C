/* Этот код реализует функцию `currTime()`, которая возвращает текущую дату и время в виде строки, отформатированной в соответствии с заданным форматом.*/

/* curr_time.c

   Реализация функции currTime().
*/

#include <time.h>
#include "curr_time.h"          // Объявление функции currTime

#define BUF_SIZE 1000           // Размер буфера для строки времени

/* Функция возвращает строку с текущим временем, отформатированным
   согласно спецификации в 'format' (см. strftime(3) для спецификаторов).
   Если 'format' равно NULL, используется формат "%c" (формат ctime(3), но
   без завершающего символа новой строки).
   Возвращает NULL в случае ошибки. */

char *currTime(const char *format)
{
    static char buf[BUF_SIZE];  // Статический буфер, не является потокобезопасным
    time_t t;                   // Переменная для хранения времени в секундах с эпохи
    size_t s;                   // Количество символов, записанных в буфер
    struct tm *tm;              // Указатель на структуру tm для разбора времени

    t = time(NULL);             // Получаем текущее время
    tm = localtime(&t);         // Преобразуем в локальное время
    if (tm == NULL)
        return NULL;            // Возвращаем NULL в случае ошибки

    // Форматируем дату и время в строку в зависимости от заданного формата или по умолчанию
    s = strftime(buf, BUF_SIZE, (format != NULL) ? format : "%c", tm);

    // Если strftime() вернул 0, значит буфер был недостаточен или возникла ошибка
    return (s == 0) ? NULL : buf;
}
/*

### Пояснение
1. **Аргумент `format`**:
   - Определяет формат отображения времени. Если `format` равен `NULL`, используется формат `"%c"`, который выводит локальные дату и время.
   
2. **Статический буфер `buf`**:
   - Статический буфер на 1000 символов, куда записывается отформатированное время. Использование статического буфера делает функцию `currTime()` не потокобезопасной, так как разные вызовы функции будут перезаписывать содержимое буфера.

3. **time()**:
   - Получает текущее время в секундах с начала эпохи (1 января 1970 года).

4. **localtime()**:
   - Преобразует время `time_t` в структуру `tm`, которая содержит разбитые компоненты даты и времени (час, минута, секунда и т.д.) в локальном часовом поясе.

5. **strftime()**:
   - Форматирует структуру `tm` в строку согласно заданному формату и записывает результат в `buf`. Если функция возвращает 0, значит произошла ошибка или размер `buf` был недостаточен.

Функция `currTime()` полезна для получения текущего времени в удобочитаемом формате с возможностью кастомизации формата вывода.
*/